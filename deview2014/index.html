<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <title>HTML5 게임</title>
    <link href="css/impress-demo.css" rel="stylesheet" />
    <script src="js/jquery-1.8.0.js"></script>
    <script src="js/clock.js"></script>
</head>

<body class="impress-not-supported">

<div id="impress">

    <div id="cover" class="step" data-x="-3500" data-y="-1500" data-rotate="15" data-scale="5">
        <div>앱 세상에서 HTML5 생존기</div>
        <div class="flipX" style="font-size:35px">HTML5 기반 모바일 단말용 게임 개발 및 최적화</div>
        <img class="positioning" src="./img/html5Planet.png">
        <img id="canvasLogo" src="./img/canvasLogo.png">
    </div>

    <div id="demo1" class="step" data-x="-3800" data-y="-2000" data-rotate="15" data-scale="0.5">
        <div style="font-size:65px">Click의 시대가 지고</div>
        <div style="font-size:65px">Touch가 앱천지를 만들다</div>
    </div>

    <div id="demo2" class="step" data-x="-3000" data-y="-1500" data-rotate="90" data-scale="0.1">
        <div>HTML5는</div>
        <div>Hype(과대 광고) or Hope(희망) 일까? </div>
    </div>

    <div id="question" class="step" data-x="-3500" data-y="-1500" data-rotate="15" data-scale="0.1">
        <div>HTML5를</div>
        <div>성공적으로 상업적으로 활용해보자</div>
    </div>

    <div id="question2" class="step" data-x="-3500" data-y="-1500" data-rotate="90" data-scale="0.01">
        <q>본 발표에서는</q>
        <div>HTML5 기반 OK 캐쉬백 오락실</div>
        <div>상용 개발시 기술 경험을 공유합니다.</div>
    </div>

    <div id="question3" class="step" data-x="-3500" data-y="-1500" data-rotate="180" data-scale="0.001">
        <q>OK 캐쉬백 오락실 기술 Overview</q>
        <div>- Web UI: CSS3D, keyframe animation</div>
        <div>- Game: Canvas/DOM Hybrid</div>
        <div>- Webview: OK 캐쉬백 App Embedded</div>
        <div>- OS: Android 2.3 이상, iOS </div>
    </div>

    <div id="question4" class="step" data-x="-3500" data-y="-1500" data-rotate-y="90" data-scale="0.001">
        <iframe width="360" height="560" src="pages/ocbArcade/cubeUI/dev.html" frameborder="0"></iframe>
        <div style="font-size:25px">데모앱 설치: Google Play/T Store에서 OK 캐쉬백으로 검색</div>
    </div>

    <div id="title2" class="step slide" data-x="-1500" data-y="-1500">
        <q>앱 세상에서 HTML5 생존기:</q>
            <div>HTML5 기반 모바일 단말용 게임 개발 및 최적화</div>
        <q>임상석 팀장 > Web 기술개발팀 > SK 플래닛</q>
        <img class="positioning" src="./img/skpLogo.png">
    </div>

    <div id="title3" class="step slide" data-x="-1500" data-y="-1500" data-scale="0.1">
        <h1 class="title">개발 이력 소개</h1>
        <div>- HTML5 Web App Platform: JavaScript (2011 - Now)</div>
        <div>- WebKit Engine: Linux/Tizen C++, C (2008 - 2011)</div>
        <div>- Mobile Firefox Browser: Linux C++ (2007 - 2008)</div>
        <div>- L4/L7 Switch/ Apache Server: Linux, C (2001 - 2006)</div>
    </div>

    <div id="environment" class="step slide" data-x="-500" data-y="-1500" data-rotate-y="90">
        <h1 class="title">HTML5 개발에 대한 단상</h1>
        <div class="content">
            <ol>
                <li> 모바일 브라우져/모바일 Web에 대한 천시
                    <ul>
                        <li>
                            서비스 소개와 App 설치 유도 페이지
                        </li>
                    </ul>
                </li>
                <li> 제3의 OS로서의 HTML5 동력 상실
                    <ul>
                        <li>
                            Cross Platform 대응 보다는 각 OS 최적화 개발
                        </li>
                    </ul>
                </li>
                <li> 엔진 성능/기능 fragementation 심화
                    <ul>
                        <li>
                            Android 버전간 성능 격차
                        </li>
                        <li>
                            Android/iOS간 성능 격차
                        </li>
                    </ul>
                </li>
                <li> HTML5 전문 개발자 부족
                    <ul>
                        <li>
                            JavaScript 정통한 개발자
                        </li>
                        <li>
                            Fragementation 극복
                        </li>
                    </ul>
                </li>
            </ol>
        </div>
    </div>

    <div id="slideCanvas" class="step slide" data-x="-500" data-y="-1500" data-rotate-x="90">
        <h1 class="title">그래도 HTML5의 죽지 않았다</h1>
        <div class="content">
            <ol>
                <li> No App Update
                    <ul>
                        <li>
                            App update 저항감 회피
                        </li>
                        <li>
                            App Store를 통한 서비스 배포 지연 회피
                        </li>
                    </ul>
                </li>
                <li> iOS/Android One Source 상용화
                    <ul>
                        <li>
                            개발 비용 효율화
                        </li>
                    </ul>
                </li>
                <li> WebView를 통한 Hybrid App의 일반화
                    <ul>
                        <li>
                            사업/기획팀 비 개발자도 Hybrid App의 장점을 이해
                        </li>
                    </ul>
                </li>
            </ol>
        </div>
    </div>

    <div id="mobileOptimized" class="step slide" data-x="0" data-y="-1500">
        <h1 class="title">SK 플래닛의 HTML5 상업적 활용 방향</h1>
        <div class="content">
            <ol>
                <li> CSS2D/3D 기반 Web UI
                    <ul>
                        <li>
                            Native 동등 수준 Web UI
                        </li>
                    </ul>
                </li>
                <li> Canvas 기반 게임
                    <ul>
                        <li>
                            App/서비스 UV 제고
                        </li>
                    </ul>
                </li>
            </ol>
        </div>
    </div>

    <div id="webPlatform" class="step slide" data-x="0" data-y="-500">
        <h1 class="title">상품화 수준 HTML5 개발을 위한 필수 지식</h1>
        <div class="content">
            <ol>
                <li>
                    WebKit 내부 동작: DOM 복잡도 관리 및 GPU 활용
                </li>
                <li>
                    개발 환경: Chrome Inspector
                </li>
                <li>
                    Fragmentation의 이해 및 처리
                </li>
                <li>
                    요구사항에 의거하여 어디까지 가능한지 판단하기: 기술적으로 타협하기
                </li>
            </ol>
        </div>
    </div>

    <div id="webkitOverview" class="step slide" data-x="0" data-y="0">
        <h1 class="title">Webkit과 Platform별 Port 이해하기</h1>
        <div class="content">
            <img width="50%" src="img/webkit-diagram.png">
            <img width="47%" src="img/graphicscontext.png">
            <img width="90%" src="img/webkitPortTable.png">
        </div>
        <div class="footnote">http://paulirish.com/2013/webkit-for-developers/</div>
    </div>

    <div id="webkitFunction" class="step slide" data-x="1000" data-y="0">
        <h1 class="title">Webkit 주요 기능 </h1>
        <div class="content">
            <ol>
                <li> Parsing(HTML, XML, CSS, JavaScript)</li>
                <li> Layout </li>
                <li> Text, graphics rendering </li>
                <li> Image decoding </li>
                <li> GPU interaction </li>
                <li> Network access </li>
                <li> HW acceleration </li>
            </ol>
        </div>
    </div>

    <div id="treeBasics" class="step slide" data-x="2000" data-y="0">
        <h1 class="title">WebKit 내부 Tree</h1>
        <div class="content">
            <ol>
                <li> DOM tree: Document내의 모든 DOM node를 갖음 </li>
                <li> RenderObject tree: DOM node중에 화면에 보이는 node </li>
                <li> RenderLayer tree: 한번에 같이 painting 할 RenderObject를 모아서 관리: 같은 z-index에 있는 node </li>
            </ol>
            <img height="500px" src="img/webkitTrees.png">
        </div>
    </div>

    <div id="treeComplexity" class="step slide" data-x="3000" data-y="0">
        <h1 class="title">DOM/Render Tree 복잡도 관리</h1>
        <div class="content">
            <ol>
                <li>DOM node 및 Render Object 개수는 최소화
                    <ul>
                        <li>DOM node 재활용: DOM node 상수 고정</li>
                        <li>동적으로 삽입/삭제</li>
                        <li>display:none 설정 -> 해당 Render Object 제거, DOM node 유지</li>
                        <li>visibility:hidden -> Tree 복잡도 유지, painting cost 절감</li>
                    </ul>
                </li>
                <li>animation동안 DOM 내용 변경 절대 지양
                    <ul>
                        <li>
                            style 변경 -> layout -> painting -> bumpy animation
                        </li>
                    </ul>
                </li>
                <li>iframe으로 view 분리 (sandboxing)
                    <ul>
                        <li>
                            iframe으로 분리되면 아무리 복잡하더라도 서로 분리된 view간 영향을 주지 않음
                        </li>
                        <li>
                            long-running app 개발시에도 메모리 leak 대응 용이
                        </li>
                    </ul>
                </li>
            </ol>
        </div>
    </div>

    <div id="treeExample" class="step slide" data-x="4000" data-y="0">
        <h1 class="title">WebKit 내부 Tree</h1>
        <div class="content">
            <img width="100%" src="img/treeExample.png">
        </div>
    </div>

    <div id="HWcompositing" class="step slide" data-x="5000" data-y="0">
        <h1 class="title">GPU기반 합성</h1>
        <div class="content">
            <ol>
                <li> CPU로 만들어진 texture는 다시 repaint되거나, 가속영역에서 제거되지 않을 경우 OpenGL ES 내에서 연속적인 합성을 위하여 재활용된다.</li>
            </ol>
            <img height="450px" src="img/renderingArch.png">
        </div>
    </div>

    <div id="tooling" class="step slide" data-x="-2000" data-y="1000">
        <h1 class="title">Chrome Inspector</h1>
        <div class="content">
            <ol>
                <li>진정한 개발을 지원하는 개발 환경의 급격한 발전</li>
                <li>Web Inspector 기능의 비약적인 발전
                    <ul>
                        <li>Timeline: style, layout, compositing</li>
                        <li>Profiling: Memory, Canvas, JavaScript</li>
                        <li>GPU Layer visualization</li>
                    </ul>
                </li>
                <li> 모바일 단말 지원
                    <ul>
                        <li>Chrome For Mobile/Chrome Webview</li>
                        <li>iOS 6 버전이상에서 Web Inspector 지원 </li>
                    </ul>
                </li>
                <li> 상세 정보
                    <ul>
                        <li>Google code school: http://discover-devtools.codeschool.com/</li>
                        <li>https://developers.google.com/chrome-developer-tools/</li>
                    </ul>
                </li>
            </ol>
        </div>
    </div>

    <div id="timeline" class="step slide" data-x="-1000" data-y="1000">
        <h1 class="title">Chrome Dev Tool: Timeline</h1>
        <div class="content">
            <ol>
                <li> 상단 panel
                    <ul>
                        <li>Events: 시간축으로 발생한 event를 순차적으로 보여줌 </li>
                        <li>Frames: 시간축으로 매 frame 단위로 event를 순차적으로 보여줌</li>
                        <li>Memory: 메모리 사용 양을 보여줌</li>
                    </ul>
                </li>
                <li> 하단 record panel
                    <ul>
                        <li>Recalculate Style: 변경된 CSS 속성값에 따라 전체 style 값을 다시 계산</li>
                        <li>Layout: 변경된 style값에 따라 element의 위치 값을 재계산</li>
                        <li>Paint: layout이 완료된 RenderLayer들에 속한 element들을 z-ordering을 고려하여 그리 </li>
                        <li>Composite Layers: Document를 구성하는 모든 RenderLayer를 합성하여 화면에 최종 출력</li>
                        <li>각종 event fire: setTimout, requestAnimationFrame등</li>
                    </ul>
                </li>
            </ol>
            <div class="timelineImg">
                <img width="900px" src="img/timeline.png">
            </div>
        </div>
    </div>

    <div id="GPULayerVisualization" class="step slide" data-x="0" data-y="1000">
        <h1 class="title">GPU 렌더링 영역 실시간 도시</h1>
        <div class="content">
            <ol>
                <li>Web page의 HW 가속 Layer를 Graphical하게 출력 해줌</li>
                <li> 설치
                    <ol>
                        <li> Chrome Canary의 about:flags page 진입</li>
                        <li> experimental debugging feature enable</li>
                        <li> browser restart</li>
                        <li> DOM inspector 설정의 experimant Tab에서 "Show Layers Panel" 클릭</li>
                        <li> Inspector 상단에 Layer panel 생성</li>
                    </ol>
                </li>
            </ol>
        </div>
    </div>

    <div id="canvasProfiling" class="step slide" data-x="1000" data-y="1000">
        <h1 class="title">Canvas Profiling</h1>
        <div class="content">
            <ol>
                <li> 캔버스의 개별 Primitive 연산결과를 Frame by Frame으로 출력 </li>
                <li> 성능 최적화시 필수 도구</li>
            </ol>
        </div>
    </div>

    <div id="canvasOptimization1" class="step slide" data-x="2000" data-y="1000">
        <h1 class="title">최적화 절대 규칙: 이것만은 기억하자</h1>
        <div class="content">
            <ol>
                <li> No painting while animating
                    <ul>
                        <li> style 변경은 layout을 야기 시킴</li>
                        <li> layout 결과는 painting </li>
                    </ul>
                </li>
                <li> less DOM complexity, less painting overhead
                </li>
            </ol>
        </div>
    </div>

    <div id="gameBiz" class="step slide" data-x="4000" data-y="1000" data-rotate="90">
        <h1 class="title">App-Embedded Branded Game</h1>
        <div class="content">
            <ul>
                <li>iOS/Android 동시 지원</li>
                <li>App Embedded: 사용자 retention</li>
                <li>No 네이티브 앱 Update</li>
                <li>30-50만명 랭킹</li>
            </ul>
        </div>
    </div>

    <div id="canvasGameCore" class="step slide" data-x="5000" data-y="1000" data-rotate="90">
        <h1 class="title">HTML5 canvas 기반 게임 개발</h1>
        <div class="content">
            <ul>
                <li>Browser 엔진은 게임 플랫폼이 아님 </li>
            </ul>
        </div>
    </div>

    <div id="mobileGameEngine" class="step slide" data-x="6000" data-y="1000" data-rotate="90">
        <h1 class="title">HTML5 canvas 기반 게임 개발</h1>
        <div class="content">
            <ul>
                <li>기존 오픈 소스 게임 엔진의 한계</li>
                <li>Mobile 단말 특화 기능</li>
            </ul>
        </div>
    </div>

    <div id="canvasGameLoop" class="step slide" data-x="7000" data-y="1000" data-rotate="90">
        <h1 class="title">canvas 게임 기본 로직</h1>
        <div class="content">
            <ul>
                <li>책장 넘기 효과</li>
                <li>지우고 그리고 지우고를 반복 </li>
            </ul>
        </div>
    </div>

    <div id="gameObject" class="step slide" data-x="8000" data-y="1000" data-rotate="90">
        <h1 class="title">Game내 Object 표현</h1>
        <div class="content">
            <ul>
                <li>Image 기반: 일반적이나 반복적인 scaling up/down</li>
                <li>Drawing primitive 조합: 최종 해상도 기준 한번에 그리기</li>
            </ul>
        </div>
    </div>

    <div id="gameRunTime" class="step slide" data-x="9000" data-y="1000" data-rotate="90">
        <h1 class="title">canvas 동작하는 RunTime의 이해</h1>
        <div class="content">
            <ul>
                <li>canvas HW 가속 미지원: Android 2.3.x, iOS4.0 </li>
                <li>Kitkat의 Chrome Webview 성능 재앙</li>
            </ul>
        </div>
    </div>

    <div id="canvasPerf" class="step slide" data-x="10000" data-y="1000">
        <h1 class="title">canvas 성능 분석</h1>
        <div class="content">
            <ul>
                <li>DOM/GPU과 Canvas 렌더링 성능 분석</li>
            </ul>
        </div>
    </div>

    <div id="kitkatDister" class="step slide" data-x="11000" data-y="1000">
        <h1 class="title">Kitkat 재앙</h1>
        <div class="content">
            <ul>
                <li>Kitkat 4.4, 4.4.2에서 painting 성능 매우 저하됨</li>
                <li>Google의 플랫폼 버그: 이미 시장에서 50%이상 차지</li>
            </ul>
        </div>
    </div>

    <div id="canvasDOMHybrid" class="step slide" data-x="12000" data-y="1000">
        <h1 class="title">DOM/Canvas Hybrid</h1>
        <div class="content">
            <ul>
                <li>Painting 영역을 최소화</li>
                <li>애니메이션이 없는 게임 Object를 DOM으로 분리</li>
            </ul>
        </div>
    </div>

    <div id="domPool" class="step slide" data-x="13000" data-y="1000">
        <h1 class="title">DOM Node Pool</h1>
        <div class="content">
            <ul>
                <li>Viewport 내의 게임 오브젝트를 담는 DOM을 Object Pool로 관리</li>
                <li>DOM Node의 재활용</li>
                <li>애니메이션이 없으므로 Object 이미지도 재활용 필수</li>
            </ul>
        </div>
    </div>

    <div id="smartREpaint" class="step slide" data-x="14000" data-y="1000">
        <h1 class="title">Invalidate 영역 관리</h1>
        <div class="content">
            <ul>
                <li>이전 Frame을 복사하여 재활용</li>
                <li>Invalidate 영역만을 redraw</li>
            </ul>
        </div>
    </div>

    <div id="imageDecodingOverhead" class="step slide" data-x="15000" data-y="1000">
        <h1 class="title">Source 이미지 크기 관리</h1>
        <div class="content">
            <ul>
                <li>Sprite 이미지 사용시 네트워크 요청 개수를 줄일수 있음</li>
                <li>원본이미지의 크기가 커지면 커질수록 destination 이미지 크기가 고정이어도 속도 저하</li>
                <li>자주 쓰이는 object는 개별 이미지로 분리</li>
            </ul>
        </div>
    </div>

    <div id="garbageCollection" class="step slide" data-x="16000" data-y="1000">
        <h1 class="title">Garbage Collection 최소화</h1>
        <div class="content">
            <ul>
                <li>게임내 모든 주요 Object는 Static Object Pool을 통해 관리</li>
                <li>Static Object 구현 방식: Single Array, Double Array, Doubly Linked List</li>
                <li>Single Array: push/pop이 가종 빠름</li>
                <li>GC를 완벽히 차단하는 것은 매우 어렵다</li>
            </ul>
        </div>
    </div>

    <div id="resolutionHandling" class="step slide" data-x="17000" data-y="1000">
        <h1 class="title">해상도 파헤치기</h1>
        <div class="content">
            <ul>
                <li>최종 화면에 하나의 Pixel이 그려지기 위해서는 다단계 Scale 발생</li>
                <li>canvas.width, canvas.height</li>
                <li>canvas.style.width, canvas.style.height</li>
                <li>drawImage(원본 이미지 위치, destination scaled 위치)</li>
                <li>window.devicePixelRatio</li>
            </ul>
        </div>
    </div>

    <div id="DOMComplexity" class="step slide" data-x="18000" data-y="1000">
        <h1 class="title">Game 실행 환경 분리</h1>
        <div class="content">
            <ul>
                <li>canvas 게임을 Web Page에 embedding 시 canvas rendering 성능 저하</li>
                <li>fps가 swing 하는 현상이 발생하며 30% 저하</li>
                <li>Web Page에 embed 시키지 말고 별도의 HTML로 작성해서 로딩</li>
            </ul>
        </div>
    </div>

    <div id="baseball" class="step slide" data-x="19000" data-y="1000">
        <h1 class="title">요리조리 베이스볼 적용 사례</h1>
        <div class="content">
            <ul>
                <li>DOM/Canvas Hybrid</li>
                <li>Smart repaint</li>
            </ul>
        </div>
    </div>

    <div id="baseballBoard" class="step slide" data-x="19000" data-y="2000">
        <h1 class="title">요리조리 베이스볼 적용 사례</h1>
        <div class="content">
            <ul>
                <li>전광판 DOM으로 분리</li>
                <li>layout 연산으로 painting overhead가 증가하여 역효과</li>
            </ul>
        </div>
    </div>

    <div id="2048game" class="step slide" data-x="20000" data-y="1000">
        <h1 class="title">2048</h1>
        <div class="content">
            <ul>
                <li>DOM/Canvas Hybrid</li>
                <li>Smart repaint</li>
                <li>DOM Node 개수 최소화, Table 제거</li>
            </ul>
        </div>
    </div>

    <div id="space2014game" class="step slide" data-x="21000" data-y="1000">
        <h1 class="title">SPACE 2014</h1>
        <div class="content">
            <ul>
                <li>clearRect VS fillRect</li>
                <li>게임 배경 단순화</li>
                <li>이전 Frame 1회 재활용</li>
            </ul>
        </div>
    </div>

    <div id="conclusion" class="step slide" data-x="21000" data-y="2000">
        <h1 class="title">결론</h1>
        <div class="content">
            <ul>
                <li>모바일 단말에서 30 fps 가능하도록 게임을 기획</li>
                <li>성능 최적화는 필수적</li>
            </ul>
        </div>
    </div>

</div>

<script src="js/impress.js"></script>
<script>
impress().init();
</script>
<script src="js/presentation.js"></script>

</body>
</html>
