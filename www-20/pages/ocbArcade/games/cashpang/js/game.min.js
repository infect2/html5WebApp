var LocalStorageManager=function(a){this.key=a};LocalStorageManager.prototype.save=function(a){window.localStorage.setItem(this.key,JSON.stringify(a))},LocalStorageManager.prototype.load=function(){var a;return a=JSON.parse(window.localStorage.getItem(this.key))},LocalStorageManager.prototype.clear=function(){window.localStorage.removeItem(this.key)},LocalStorageManager.prototype.allClear=function(){window.localStorage.clear()};var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new f.init(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new f.init(c,b/2)}},i=g.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new f.init(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=e/(4*g),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*g,e=a.min(4*b,e),b){for(var i=0;b>i;i+=g)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new f.init(i,e)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=k.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new l.HMAC.init(a,c).finalize(b)}}});var l=c.algo={};return c}(Math);!function(){var a=CryptoJS,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;c>e;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&c>e+.75*g;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;c>g;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function b(a,b,c,d,e,f,g){return a=a+(b&c|~b&d)+e+g,(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return a=a+(b&d|c&~d)+e+g,(a<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return a=a+(b^c^d)+e+g,(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return a=a+(c^(b|~d))+e+g,(a<<f|a>>>32-f)+b}var f=CryptoJS,g=f.lib,h=g.WordArray,i=g.Hasher,g=f.algo,j=[];!function(){for(var b=0;64>b;b++)j[b]=4294967296*a.abs(a.sin(b+1))|0}(),g=g.MD5=i.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var g=this._hash.words,h=a[f+0],i=a[f+1],k=a[f+2],l=a[f+3],m=a[f+4],n=a[f+5],o=a[f+6],p=a[f+7],q=a[f+8],r=a[f+9],s=a[f+10],t=a[f+11],u=a[f+12],v=a[f+13],w=a[f+14],x=a[f+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,j[0]),B=b(B,y,z,A,i,12,j[1]),A=b(A,B,y,z,k,17,j[2]),z=b(z,A,B,y,l,22,j[3]),y=b(y,z,A,B,m,7,j[4]),B=b(B,y,z,A,n,12,j[5]),A=b(A,B,y,z,o,17,j[6]),z=b(z,A,B,y,p,22,j[7]),y=b(y,z,A,B,q,7,j[8]),B=b(B,y,z,A,r,12,j[9]),A=b(A,B,y,z,s,17,j[10]),z=b(z,A,B,y,t,22,j[11]),y=b(y,z,A,B,u,7,j[12]),B=b(B,y,z,A,v,12,j[13]),A=b(A,B,y,z,w,17,j[14]),z=b(z,A,B,y,x,22,j[15]),y=c(y,z,A,B,i,5,j[16]),B=c(B,y,z,A,o,9,j[17]),A=c(A,B,y,z,t,14,j[18]),z=c(z,A,B,y,h,20,j[19]),y=c(y,z,A,B,n,5,j[20]),B=c(B,y,z,A,s,9,j[21]),A=c(A,B,y,z,x,14,j[22]),z=c(z,A,B,y,m,20,j[23]),y=c(y,z,A,B,r,5,j[24]),B=c(B,y,z,A,w,9,j[25]),A=c(A,B,y,z,l,14,j[26]),z=c(z,A,B,y,q,20,j[27]),y=c(y,z,A,B,v,5,j[28]),B=c(B,y,z,A,k,9,j[29]),A=c(A,B,y,z,p,14,j[30]),z=c(z,A,B,y,u,20,j[31]),y=d(y,z,A,B,n,4,j[32]),B=d(B,y,z,A,q,11,j[33]),A=d(A,B,y,z,t,16,j[34]),z=d(z,A,B,y,w,23,j[35]),y=d(y,z,A,B,i,4,j[36]),B=d(B,y,z,A,m,11,j[37]),A=d(A,B,y,z,p,16,j[38]),z=d(z,A,B,y,s,23,j[39]),y=d(y,z,A,B,v,4,j[40]),B=d(B,y,z,A,h,11,j[41]),A=d(A,B,y,z,l,16,j[42]),z=d(z,A,B,y,o,23,j[43]),y=d(y,z,A,B,r,4,j[44]),B=d(B,y,z,A,u,11,j[45]),A=d(A,B,y,z,x,16,j[46]),z=d(z,A,B,y,k,23,j[47]),y=e(y,z,A,B,h,6,j[48]),B=e(B,y,z,A,p,10,j[49]),A=e(A,B,y,z,w,15,j[50]),z=e(z,A,B,y,n,21,j[51]),y=e(y,z,A,B,u,6,j[52]),B=e(B,y,z,A,l,10,j[53]),A=e(A,B,y,z,s,15,j[54]),z=e(z,A,B,y,i,21,j[55]),y=e(y,z,A,B,q,6,j[56]),B=e(B,y,z,A,x,10,j[57]),A=e(A,B,y,z,o,15,j[58]),z=e(z,A,B,y,v,21,j[59]),y=e(y,z,A,B,m,6,j[60]),B=e(B,y,z,A,t,10,j[61]),A=e(A,B,y,z,k,15,j[62]),z=e(z,A,B,y,r,21,j[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296);for(c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.sigBytes=4*(c.length+1),this._process(),b=this._hash,c=b.words,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8);return b},clone:function(){var a=i.clone.call(this);return a._hash=this._hash.clone(),a}}),f.MD5=i._createHelper(g),f.HmacMD5=i._createHmacHelper(g)}(Math),function(){var a=CryptoJS,b=a.lib,c=b.Base,d=b.WordArray,b=a.algo,e=b.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,e=c.hasher.create(),f=d.create(),g=f.words,h=c.keySize,c=c.iterations;g.length<h;){i&&e.update(i);var i=e.update(a).finalize(b);e.reset();for(var j=1;c>j;j++)i=e.finalize(i),e.reset();f.concat(i)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return e.create(c).compute(a,b)}}(),CryptoJS.lib.Cipher||function(a){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,f=c.BufferedBlockAlgorithm,g=b.enc.Base64,h=b.algo.EvpKDF,i=c.Cipher=f.extend({cfg:d.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){f.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){return function(a){return{encrypt:function(b,c,d){return("string"==typeof c?o:n).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?o:n).decrypt(a,b,c,d)}}}}()});c.StreamCipher=i.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var j=b.mode={},k=c.BlockCipherMode=d.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}}),j=j.CBC=function(){function b(b,c,d){var e=this._iv;e?this._iv=a:e=this._prevBlock;for(var f=0;d>f;f++)b[c+f]^=e[f]}var c=k.extend();return c.Encryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize;b.call(this,a,c,e),d.encryptBlock(a,c),this._prevBlock=a.slice(c,c+e)}}),c.Decryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize,f=a.slice(c,c+e);d.decryptBlock(a,c),b.call(this,a,c,e),this._prevBlock=f}}),c}(),l=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,f=[],g=0;c>g;g+=4)f.push(d);c=e.create(f,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}};c.BlockCipher=i.extend({cfg:i.cfg.extend({mode:j,padding:l}),reset:function(){i.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var m=c.CipherParams=d.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),j=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return a=a.salt,(a?e.create([1398893684,1701076831]).concat(a).concat(b):b).toString(g)},parse:function(a){a=g.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=e.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return m.create({ciphertext:a,salt:c})}},n=c.SerializableCipher=d.extend({cfg:d.extend({format:j}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,m.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=e.random(8)),a=h.create({keySize:b+c}).compute(a,d),c=e.create(a.words.slice(b),4*c),a.sigBytes=4*b,m.create({key:a,iv:c,salt:d})}},o=c.PasswordBasedCipher=n.extend({cfg:n.cfg.extend({kdf:b}),encrypt:function(a,b,c,d){return d=this.cfg.extend(d),c=d.kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,a=n.encrypt.call(this,a,b,c.key,d),a.mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,n.decrypt.call(this,a,b,c.key,d)}})}(),function(){function a(a){return d[3][a>>>24&255]^d[2][a>>>16&255]^d[1][a>>>8&255]^d[0][255&a]}var b=CryptoJS,c=b.lib.BlockCipher,d=[[696885672,92635524,382128852,331600848,340021332,487395612,747413676,621093156,491606364,54739776,403181592,504238620,289493328,1020063996,181060296,591618912,671621160,71581764,536879136,495817116,549511392,583197408,147374280,386339604,629514660,261063564,50529024,994800504,999011256,318968592,314757840,785310444,809529456,210534540,1057960764,680042664,839004720,500027868,919007988,876900468,751624428,361075092,185271048,390550356,474763356,457921368,1032696252,16843008,604250148,470552604,860058480,411603096,268439568,214745292,851636976,432656856,738992172,667411428,843215472,58950528,462132120,297914832,109478532,164217288,541089888,272650320,595829664,734782440,218956044,914797236,512660124,256852812,931640244,441078360,113689284,944271480,646357668,302125584,797942700,365285844,557932896,63161280,881111220,21053760,306336336,1028485500,227377548,134742024,521081628,428446104,0,420024600,67371012,323179344,935850996,566354400,1036907004,910586484,789521196,654779172,813740208,193692552,235799052,730571688,578986656,776888940,327390096,223166796,692674920,1011642492,151585032,168428040,1066382268,802153452,868479984,96846276,126321540,335810580,1053750012,608460900,516870876,772678188,189481800,436867608,101057028,553722144,726360936,642146916,33686016,902164980,310547088,176849544,202113036,864269232,1045328508,281071824,977957496,122110788,377918100,633725412,637936164,8421504,764256684,533713884,562143648,805318704,923218740,781099692,906375732,352653588,570565152,940060728,885321972,663200676,88424772,206323788,25264512,701096424,75792516,394761108,889532724,197903304,248431308,1007431740,826372464,285282576,130532292,160006536,893743476,1003222008,449499864,952692984,344232084,424235352,42107520,80003268,1070593020,155795784,956903736,658989924,12632256,265274316,398971860,948482232,252642060,244220556,37896768,587408160,293704080,743202924,466342872,612671652,872689716,834793968,138952776,46318272,793731948,1024274748,755835180,4210752,1049539260,1041117756,1015853244,29475264,713728680,982168248,240009804,356864340,990589752,483184860,675831912,1062171516,478974108,415813848,172638792,373707348,927429492,545300640,768467436,105267780,897954228,722150184,625303908,986379e3,600040416,965325240,830583216,529503132,508449372,969535992,650568420,847426224,822161712,717939432,760045932,525292380,616882404,817950960,231588300,143163528,369496596,973746744,407392344,348442836,574775904,688464168,117900036,855847728,684253416,453710616,84214020,961114488,276861072,709517928,705307176,445289112],[943196208,3894986976,741149985,2753988258,3423588291,3693006546,2956166067,3090712752,2888798115,1612726368,1410680145,3288844227,1141130304,1815039843,1747667811,1478183763,3221472195,1612857954,808649523,3023406513,673777953,2686484640,3760374498,2754054051,3490956243,2417066385,269549841,67503618,471600144,3158084784,875955762,1208699715,3962556387,2282260608,1814842464,2821228704,337053459,3288646848,336987666,4097098992,3221406402,1141196097,3760308705,3558262482,1010765619,1010634033,2349764226,2551744656,673712160,1276005954,4097230578,1010699826,2753922465,4164536817,202181889,3693072339,3625502928,673909539,1680229986,2017086066,606537507,741281571,4029792753,1882342002,1073889858,3558130896,1073824065,3221274816,1882407795,1680295779,2888600736,2282457987,4097296371,2888666529,2147516544,471797523,3356150466,741084192,2821360290,875824176,3490890450,134941443,3962490594,3895052769,1545424209,2484372624,404228112,4164471024,1410811731,2888732322,134744064,3288712641,269681427,3423456705,2215020162,3090778545,4232040435,2084392305,3221340609,808517937,4097164785,2282392194,1747602018,2956034481,3490824657,538968096,3558328275,131586,539099682,67372032,1747470432,1882276209,67569411,3625700307,2619182481,2551810449,1612792161,3158216370,3827746530,1478052177,3692940753,1343308113,2417000592,3692874960,2551876242,2686682019,2821426083,3490758864,2147582337,202313475,1141327683,404359698,3760440291,3962359008,2349698433,3158282163,2484504210,2017151859,1545358416,2686616226,2686550433,1612923747,539165475,1275940161,3356018880,2619248274,2619116688,943327794,202116096,741215778,3090844338,1814974050,2619314067,1478117970,4029858546,2417132178,4029924339,1208568129,2016954480,3423390912,336921873,4164668403,1882210416,1949648241,2084523891,875889969,269484048,197379,1680098400,1814908257,3288778434,1949582448,3558196689,3023340720,3895118562,134809857,1949714034,404293905,4231974642,1073758272,269615634,3760242912,3158150577,67437825,4164602610,65793,4029726960,673843746,1545490002,2821294497,1410745938,1073955651,2214954369,336856080,2282326401,2551942035,2955968688,3827680737,1208502336,2017020273,2484570003,4231843056,471731730,2147648130,539033889,2349632640,404425491,1545555795,1949779827,1410614352,2956100274,471665937,606405921,1276071747,0,1141261890,3962424801,1477986384,1343373906,3895184355,2084458098,3625634514,3356084673,4231908849,808452144,2484438417,1680164193,1010568240,3023472306,3827614944,3090910131,2084326512,202247682,1343242320,943262001,606471714,808583730,2214888576,1747536225,2417197971,876021555,3827812323,606340128,2753856672,3356216259,1343439699,134875650,2215085955,3625568721,1275874368,2147713923,2349830019,3423522498,943393587,1208633922,3023538099],[2712152457,2172913029,3537114822,3553629123,1347687492,287055117,2695638156,556016901,1364991309,1128268611,270014472,303832590,1364201793,4043062476,3267889866,1667244867,539502600,1078199364,538976256,2442927501,3772784832,3806339778,3234334920,320083719,2711889285,2206994319,50332419,1937259339,3015195531,319820547,3536851650,3807129294,1886400576,2156661900,859586319,2695374984,842019330,3520863693,4076091078,1886663748,3773574348,2442401157,50858763,1398019911,1348213836,1398283083,2981903757,16777473,539239428,270277644,1936732995,2425886856,269488128,3234598092,4075827906,3520600521,539765772,3823380423,1919955522,2206204803,2476219275,3520074177,2189690502,3251112393,1616912448,1347424320,2745181059,3823643595,17566989,2998154886,2459704974,1129058127,3014932359,1381505610,3267626694,1886926920,2728666758,303043074,2745970575,3520337349,1633689921,3284140995,2964599940,1094713665,1380979266,1903967565,2173439373,526344,320610063,2442664329,0,286791945,263172,1397756739,4092868551,3789562305,4059839949,1920218694,590098191,589571847,2964336768,2206731147,34344462,2745707403,2728403586,1651256910,2475692931,1095503181,1634216265,1887190092,17303817,34081290,3015458703,3823906767,4092605379,3250849221,2206467975,269751300,4076617422,1617175620,3537641166,573320718,1128794955,303569418,33818118,555753729,1667771211,1650730566,33554946,4059313605,2458915458,2189953674,789516,3014669187,1920745038,3503296704,1920481866,1128531783,2459178630,3789825477,572794374,2155872384,2712415629,3554418639,2711626113,808464384,859059975,2729193102,842282502,286528773,572531202,808990728,4042536132,2745444231,1094976837,1078725708,2172649857,3790088649,2156135556,2475956103,825505029,3284667339,3268153038,809253900,1903178049,286265601,3284404167,2173176201,1903441221,4093131723,3537377994,4042799304,2425623684,1364728137,2189427330,3234071748,4093394895,1095240009,825768201,1667508039,3233808576,3284930511,3553892295,2964863112,51121935,2190216846,1111491138,589308675,2442137985,1617701964,3554155467,2695111812,808727556,4059050433,1078462536,3267363522,1668034383,826031373,556543245,1077936192,2998681230,842808846,2965126284,3250586049,2728929930,2998418058,1112280654,1364464965,859323147,3504086220,1617438792,1937522511,2426150028,3503823048,1112017482,1381242438,1936996167,2694848640,3790351821,1111754310,2981377413,589835019,1633953093,4076354250,3823117251,2981640585,2981114241,2476482447,1381768782,4059576777,3806602950,2997891714,825241857,3806866122,1634479437,1398546255,3773048004,4042272960,3251375565,2156398728,303306246,842545674,1347950664,3503559876,1650467394,556280073,50595591,858796803,3773311176,320346891,17040645,1903704393,2425360512,1650993738,573057546,2459441802],[137377848,3370182696,220277805,2258805798,3485715471,3469925406,2209591347,2293282872,2409868335,1080057888,1162957845,3351495687,1145062404,1331915823,1264805931,1263753243,3284385795,1113743394,53686323,2243015733,153167913,2158010400,3269648418,2275648551,3285438483,2173800465,17895441,100795398,202382364,2360392764,103953462,1262700555,3487820847,2290124808,1281387564,2292230184,118690839,3300967428,101848086,3304125492,3267543042,1161905157,3252805665,3335705622,255015999,221330493,2390920206,2291177496,136325160,1312967694,3337810998,238173246,2241963045,3388078137,218172429,3486768159,3369130008,186853419,1180853286,1249015866,119743527,253963311,3253858353,1114796082,1111638018,3302020116,1094795265,3233857536,1131638835,1197696039,2359340076,2340653067,3354653751,2376182829,2155905024,252910623,3401762826,203435052,2325915690,70267956,3268595730,184748043,3470978094,3387025449,1297177629,2224067604,135272472,3371235384,1196643351,2393025582,134219784,3317810181,51580947,3452029965,2256700422,2310125625,3488873535,1299283005,3250700289,20000817,3320968245,2323810314,1247963178,2175905841,3251752977,2105376,3352548375,33685506,35790882,67109892,1214277672,1097953329,117638151,3419658267,2375130141,2308020249,1096900641,2394078270,3336758310,1230067737,3453082653,1095847953,2156957712,3436239900,2324863002,2208538659,2342758443,3234910224,2172747777,251857935,1195590663,168957978,3286491171,3437292588,2374077453,2410921023,2257753110,1265858619,1280334876,2191695906,2174853153,1130586147,52633635,1296124941,3368077320,2391972894,2358287388,171063354,201329676,237120558,2326968378,1315073070,2408815647,1246910490,3270701106,2190643218,3287543859,1229015049,1215330360,3435187212,85005333,3421763643,1081110576,1165063221,1332968511,87110709,1052688,50528259,1147167780,1298230317,3334652934,1148220468,3318862869,2226172980,3403868202,151062537,1181905974,152115225,3472030782,1077952512,34738194,3235962912,2377235517,83952645,3404920890,16842753,3237015600,170010666,1314020382,2309072937,1179800598,1128480771,2239857669,68162580,2306967561,2341705755,2159063088,3319915557,1212172296,1232173113,2274595863,3438345276,236067870,2189590530,18948129,2357234700,185800731,1330863135,1198748727,1146115092,2192748594,219225117,86058021,1329810447,0,1178747910,3454135341,1213224984,1112690706,3420710955,1316125758,3402815514,3384920073,3455188029,3158064,2240910357,1164010533,204487740,2259858486,3303072804,2343811131,1282440252,235015182,1079005200,154220601,102900774,36843570,2223014916,1231120425,2207485971,120796215,3353601063,69215268,2225120292,3418605579,1129533459,167905290,2273543175,3385972761,1279282188,2206433283,2407762959,3468872718,187906107,1245857802,2276701239]],e=[2654435769,1013904243,2027808486,4055616972,3816266649,3337566003,2380164711,465362127,930724254,1861448508,3722897016,3150826737,2006686179,4013372358,3731777421,3168587547],f=b.algo.SEED=c.extend({_doReset:function(){for(var b=this._key,c=b.words[0],d=b.words[1],f=b.words[2],b=b.words[3],g=[],h=0;16>h;h++)if(g[h]=[],g[h][0]=a(c+f-e[h]),g[h][1]=a(d-b+e[h]),0==h%2)var i=c,c=c>>>8|d<<24,d=d>>>8|i<<24;else i=f,f=f<<8|b>>>24,b=b<<8|i>>>24;this._roundKeys=g,this._invRoundKeys=g.slice().reverse()},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._roundKeys)},decryptBlock:function(a,b){this._doCryptBlock(a,b,this._invRoundKeys)},_doCryptBlock:function(b,c,d){for(var e=b.slice(c,c+2),f=b.slice(c+2,c+4),g=[e,f],e=0;16>e;e++){var f=d[e],h=g[0],g=g[1],i=[];i[0]=g[0]^f[0],i[1]=g[1]^f[1],i[1]^=i[0],i[1]=a(i[1]),i[0]+=i[1],i[0]=a(i[0]),i[1]+=i[0],i[1]=a(i[1]),i[0]+=i[1],h[0]^=i[0],h[1]^=i[1],g=[g,h]}g.reverse(),b.splice(c,4,g[0][0],g[0][1],g[1][0],g[1][1])},keySize:4,ivSize:4,blockSize:4});b.SEED=c._createHelper(f)}(),CryptoJS.mode.ECB=function(){var a=CryptoJS.lib.BlockCipherMode.extend();return a.Encryptor=a.extend({processBlock:function(a,b){this._cipher.encryptBlock(a,b)}}),a.Decryptor=a.extend({processBlock:function(a,b){this._cipher.decryptBlock(a,b)}}),a}(),CryptoJS.pad.AnsiX923={pad:function(a,b){var c=a.sigBytes,d=4*b,e=d-c%d,f=c+e-1;a.clamp(),a.words[f>>>2]|=e<<24-f%4*8,a.sigBytes+=e},unpad:function(a){var b=255&a.words[a.sigBytes-1>>>2];a.sigBytes-=b}},function(){Object.create||(Object.create=function(){function a(){}return function(b){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}()),isNaN||(window.isNaN=function(a){return a!==a}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var a=window.PubSub=function(){};a.prototype.trigger=function(a,b){"undefined"==typeof this._eventHandlers&&(this._eventHandlers=[]);var c,d,e=[];for(c=0;c<this._eventHandlers.length;c++)if(this._eventHandlers[c].name===a){for(d=0;d<this._eventHandlers[c].fn.length;d++)e.push(this._eventHandlers[c].fn[d].call(this,b));break}for(c=0;c<e.length;c++)if(e[c]===!1)return!1;return!0},a.prototype.on=function(a,b){var c,d=-1;if("undefined"==typeof this._eventHandlers&&(this._eventHandlers=[]),"undefined"==typeof b&&"string"!=typeof a){for(var e in a)this.on(e,a[e]);return this}for(c=0;c<this._eventHandlers.length;c++)this._eventHandlers[c].name===a&&(d=c);return 0>d?this._eventHandlers.push({name:a,fn:[b]}):this._eventHandlers[d].fn.push(b),this}}(),function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),requirejs.config({baseUrl:"engine/module",paths:{lib:"lib",ocb:"../../js"},waitSeconds:15}),alert(document),require(["ocb/main","ocb/resource"],function(a,b){function c(a){var b,c,d,e,f,g=[{levelDesc:"초하수",levelID:"lv-6",startPnt:0,endPnt:31500,startRate:97,endRate:100},{levelDesc:"하수",levelID:"lv-5",startPnt:31501,endPnt:63750,startRate:84,endRate:97},{levelDesc:"중수",levelID:"lv-4",startPnt:63751,endPnt:291500,startRate:16,endRate:84},{levelDesc:"고수",levelID:"lv-3",startPnt:291501,endPnt:456e3,startRate:4,endRate:16},{levelDesc:"초고수",levelID:"lv-2",startPnt:456001,endPnt:828250,startRate:.1,endRate:3},{levelDesc:"신(神)",levelID:"lv-1",startPnt:828251,endPnt:"Infinity",startRate:0,endRate:.1}],h=g.length;for(c=0;h>c;c++)if(b=g[c],!(b.startPnt>a||b.endPnt<a)){d=b.levelDesc,e=b.levelID,f=function(){var c,d=(b.endRate-b.startRate)/(b.endPnt-b.startPnt);return c=b.endRate-d*(a-b.startPnt),.1>=c&&(c=.1),c>100&&(c=100),c>.1&&(c=10*c,c=Math.ceil(c),c/=10),c.toString()}();break}return console.log(d),console.log(e),console.log(f),{levelDesc:d,levelID:e,rate:f}}var d,e,f=!1,g=$(".score");alert("require");var h=navigator.userAgent.toLowerCase(),i=function(){a.game.trigger("ready")};$(document).ready(function(){alert("ready");{var j;(window.innerWidth-200)/2}if(alert(h),!/Android 2/i.test(h)&&(e=new LocalStorageManager("cashpang"),j=e.load(),d=null===j?0:j.score,g.text(d),d>0)){var k={},l=c(d);k.score=d,k.level=l.levelID,k.rate=l.rate,e.save(k)}alert("befor load"),a.game.loader.loadResources(b).then(function(){f=!0,alert("in loadresource"),i()},function(){alert("네트워크 장애로 인해 게임 로드에 실패했습니다.<br> 잠시 후 다시 시도해주세요.")})}),$("._gameCanvas").on("finish",function(a,b){var f={},i=c(b);$(".p2 strong").addClass(i.levelID),$(".p1 strong").text(i.rate),$(".game-result").removeClass("hidden"),f.score=b,f.level=i.levelID,f.rate=i.rate,b>d&&(/Android 2/i.test(h)||e.save(f),g.text(b),console.log(b))}),$(".restartBtn").on("click",function(){window.location.reload()}),$(".backBtn").on("click",function(){window.location.href="http://egame.skmcgw.com/planetArcade/client/index.html"})}),define("ocb/main",["pwge/game","ocb/cashpang","ocb/resource"],function(a,b){var c=!1,d=(window.navigator.userAgent,new a({container:window,canvas:document.getElementById("cashpangCanvas"),resolution:{quality:"high",width:1080,height:1350},viewport:c?"default":"scale_to_fit",clearCanvasOnEveryFrame:!1,planetWebview:!1,viewportAlign:{vertical:"top",horizontal:"center"},quality:"low",maxQuality:"mid"})),e=new b({game:d});DEBUG&&(window.cashpang=e);var f=(d.boardManager.makeBoard("playBgBoard"),d.boardManager.makeBoard("playBoard",{offsetY:252})),g=(d.boardManager.makeBoard("playFgBoard"),d.boardManager.makeBoard("headerBoard")),h=(d.boardManager.makeBoard("scoreBoard"),d.boardManager.makeBoard("endBoard"));d.renderer.makeScene("playScene",["playBgBoard","playBoard","playFgBoard","headerBoard"]),d.renderer.makeScene("endScene",["endBoard"]);var i,j,k=d.entityPool.allocate({x:0,y:0,width:1080,height:238}).addTo("headerBoard"),l=d.entityPool.allocate({x:0,y:0,width:458,height:148}).addTo("headerBoard").disable(),m=d.entityPool.allocate({x:63,y:162,width:942,height:56}).addTo("headerBoard"),n=d.entityPool.allocate({x:140,y:360,width:808,height:433}).addTo("headerBoard").disable(),o=["c0","c1","c2","c3","c4","c5","c6","c7","c8","c9"],p=[];for(i=0;2>i;i++)p.push(d.entityPool.allocate({x:82+50*i,y:20,width:50,height:60}).addTo("headerBoard").disable());var q=function(a){var b={duration:70,from:{scaleX:.8,scaleY:.8},to:{scaleX:1.1,scaleY:1.1},easing:{scaleX:"easeInQuad",scaleY:"easeInQuad"},callback:function(){a.animate(c)}},c={duration:30,from:{scaleX:1.1,scaleY:1.1},to:{scaleX:1,scaleY:1},easing:{scaleX:"easeInQuad",scaleY:"easeInQuad"}};a.enable().animate(b)},r=function(){var a=Math.min(99,e.getCombo());p[0].applySprite(o[Math.floor(a/10)]),p[1].applySprite(o[a%10]),l.enable(),q(p[0].enable()),q(p[1].enable())},s=function(){l.disable(),p[0].disable(),p[1].disable()},t=[];for(i=0;2>i;i++)t.push(d.entityPool.allocate({x:505+35*i,y:162,width:35,height:42}).addTo("headerBoard"));var u=function(a){t[0].setBaseSprite("t"+Math.floor(a/10)),t[1].setBaseSprite("t"+a%10)},v=function(a){g.pause(),setTimeout(function(){g.resume()},a||e.animationDuration)},w=function(a){n.enable(),d.soundManager.playSound("suffle"),setTimeout(function(){n.disable()},a||1500)},x=(d.entityPool.allocate({x:d.viewport.designWidth/2-50,y:138,width:240,height:150}).addTo("headerBoard"),!1);m.step=function(a){if(m.sprite){var b=a%1e3;a-=b,m.width=Math.max(942*(6e4-a)/6e4,0),m.sprite.width=Math.max(942*d.viewport.imageRatio*(6e4-a)/6e4,0),u(Math.min(60,Math.max((6e4-a)/1e3,0)))}};var y=d.entityPool.allocate({x:0,y:238,width:1080,height:1112}).addTo("playBgBoard"),z=d.entityPool.allocate({x:0,y:238,width:1080,height:1112}).addTo("playBgBoard").disable(),A=d.entityPool.allocate({x:0,y:0,width:1080,height:1350}).addTo("playFgBoard").disable(),B=d.entityPool.allocate({x:0,y:0,width:1080,height:1350}).addTo("playFgBoard").disable(),C=d.entityPool.allocate({x:0,y:0,width:1080,height:1350}).addTo("headerBoard").disable(),D=d.entityPool.allocate({x:0,y:0,width:1080,height:1350}).addTo("headerBoard").disable(),E=[];for(i=0,j=7;j>i;i++)E.push(d.entityPool.allocate({x:d.viewport.designWidth-52*j-65+52*i,y:35,width:60,height:90}).addTo("headerBoard"));var F=["zero","one","two","three","four","five","six","seven","eight","nine"],G=d.entityPool.allocate().addTo("headerBoard");G.step=function(){for(var a=e.getScore(),b=a.toString().split(""),c=0;c<b.length;c++)E[c+(E.length-b.length)].setBaseSprite(F[b[c]])};var H=function(){return x?(z.opacity=0,void z.disable()):void z.animate({duration:300,from:{opacity:0},to:{opacity:.2},easing:{opacity:"linear"},callback:I})},I=function(){return x?(z.opacity=0,void z.disable()):void z.animate({duration:300,from:{opacity:.2},to:{opacity:0},easing:{opacity:"linear"},callback:H})
},J=[[0,function(){g.pause(),A.enable(),d.soundManager.playSound("ready")}],[1500,function(){A.disable(),B.enable(),d.soundManager.playSound("start")}],[2e3,function(){B.disable(),e.start(),g.resume()}]],K=[[5e4,function(){z.enable(),H(),d.soundManager.stopMusic("play"),d.soundManager.playMusic("countdown",!0)}],[6e4,function(){console.log("end game"),d.trigger("end")}]],L=[[0,function(){console.log("end, rendererstop"),console.log("stop")}]],M=d.entityPool.allocate({x:0,y:0,width:d.viewport.designWidth,height:d.viewport.designHeight,detectable:!1}).addTo("endBoard");return d.on("ready",function(){alert("ready"),k.setBaseSprite("headerBg"),l.setBaseSprite("comboBox"),m.setBaseSprite("Timer"),n.setBaseSprite("noPossibleMatch"),y.setBaseSprite("playBg"),z.setBaseSprite("flashBg"),C.setBaseSprite("gameOver"),D.setBaseSprite("lastpang"),M.setBaseSprite("endBg"),A.setBaseSprite("ready"),B.setBaseSprite("Go"),e.on("pause",v),e.on("no possible match",w),e.on("combo",r),e.on("hide combo",s),f.timeline(J),g.timeline(K),h.timeline(L),alert("ready"),d.trigger("play")}),d.on("play",function(){E.forEach(function(a){a.setBaseSprite("zero")}),x=!1,$(".popupContainer").removeClass("shown").addClass("hidden"),alert("play"),d.soundManager.playMusic("play",!0),e.init(f),d.renderer.start(),d.renderer.switchScene("playScene","fade")}),d.on("lastpang",function(){C.disable(),d.soundManager.playSound("lastpang"),D.enable().animate({duration:200,from:{x:500},to:{x:D.x},easing:{x:"easeInQuad"}})}),d.on("abort",function(){B.disable(),A.disable(),D.disable(),C.disable(),d.soundManager.stopMusic("play"),d.soundManager.stopMusic("countdown"),d.renderer.stop(),e.fire("abort")}),d.on("end",function(){x=!0,C.enable().animate({duration:300,from:{x:D.x},to:{x:C.x},easing:{x:"easeInQuad"}}),d.soundManager.playSound("gameover"),d.soundManager.stopMusic("countdown"),e.end(function(){B.disable(),A.disable(),D.disable(),C.disable(),d.soundManager.stopMusic("play"),d.soundManager.stopMusic("countdown"),d.soundManager.playSound("end"),d.renderer.switchScene("endScene","slideInRight"),$("._gameCanvas").trigger("finish",e.getScore())})}),e}),define("ocb/cashpang",["pwge/util"],function(a){function b(){var a,b=[],c=function(a){this.indexOf(a)<0&&this.push(a)};for(a=0;a<arguments.length;a++)arguments[a].forEach(c,b);return b}var c={totalTypes:7,types:["white","yellow","orange","purple","blue","green","red"],specialTypes:{3:"bomb",4:"cross",5:"bomb",6:"cross"},boardWidth:8,boardHeight:8,gemWidth:135,gemHeight:135,pangAnimWidth:180,pangAnimHeight:180,comboTimer:2e3,initialComboTimer:2e3,minComboTimer:1412,comboTimerDesc:150,comboCnt:5,eachPoint:250,comboBonus:750,maxComboBonus:6e3,bombBonus:2e3,crossBonus:5e3,animationDuration:150,offsetY:80},d="ontouchstart"in window,e=d?"touchstart":"mousedown",f=d?"touchmove":"mousemove",g=d?"touchend":"mouseup",h=[5,1,5,5,4,5,6,0,1,5,4,4,5,3,3,5,2,3,2,5,3,3,0,3,3,3,2,2,3,2,1,3,4,0,6,3,1,5,3,0,5,6,0,1,1,4,3,5,6,0,2,2,3,2,5,6,0,0,3,2,2,4,6,0],i=!1,j=function(b){var d=this;a.extend(this,c,b),this.board=[],this.registry={},this.judge=this.game.entityPool.allocate().disable(),this.judge.step=function(){this.cascade(!0)}.bind(this),this.hint=this.game.entityPool.allocate({x:-100,y:-100,z:3,width:this.gemWidth,height:this.gemHeight,anchorX:this.gemWidth/2,anchorY:this.gemHeight/2}).disable(),this.selected=this.game.entityPool.allocate({x:-100,y:-100,z:4,width:this.gemWidth,height:this.gemHeight,anchorX:this.gemWidth/2,anchorY:this.gemHeight/2}).disable(),this._onTouchstart=this.onTouchstart.bind(this),this._onTouchend=this.onTouchEnd.bind(this),this.moveHandler=this.onTouchMove.bind(this),this.game.input.on(e,this._onTouchstart),this.game.input.on(g,this._onTouchend),this.game.input.on("touchcancel",this._onTouchend),this.on("pause",function(a){a=a||d.animationDuration,d.touchable=!1,setTimeout(function(){d.touchable=!0},a),d.comboTimer+=a}),this.on("abort",function(){"undefined"!=typeof d.gameoverTimer&&clearTimeout(d.gameoverTimer),d.touchable=!1,d.fire("hide combo")})};return j.prototype.init=function(a){this.touchable=!1,this.engineBoard=a,this.score=0,this.comboCnt=0,this.offsetY=a.offsetY;var b,c=-64;for(c=63;c>=-64;c--)this.board[c]&&this.board[c].destroy();for(this.board=[],c=this.engineBoard.entities.length;c--;)(this.engineBoard.entities[c]&&"effect"===this.engineBoard.entities[c].name||"gem"===this.engineBoard.entities[c].name)&&(b=this.engineBoard.entities.splice(c,1)[0],b.destroy());this.lastpangCalled=!1,this.lastpangCallback=void 0,this.gameover=!1,this.gemCnts={},this.cascadeCnt=0,this._hintGem=void 0,this.hint.setBaseSprite("hint").addTo(this.engineBoard.name),this.selected.setBaseSprite("selected").addTo(this.engineBoard.name),this.judge.addTo(this.engineBoard.name),this.hideHint(),this.hideSelected(),this.generateBoard()},j.prototype.start=function(){this.touchable=!0,this.score=0,this.comboCnt=0,this.maxCombo=0,this.timeLastMatch=(new Date).getTime(),this.judge.enable()},j.prototype.end=function(a){this.hideHint(),this.hideSelected(),this.touchable=!1,this.gameover=!0,this.gameoverTimer=setTimeout(function(){this.hasSpecial()?(this.game.trigger("lastpang"),setTimeout(function(){this.lastpangCalled=!0}.bind(this),1500)):this.lastpangCalled=!0}.bind(this),1500),this.lastpangCallback=a},j.prototype.getGemAt=function(a,b){return this.board[a*this.boardWidth+b]},j.prototype.getGemIdx=function(a,b){return a*this.boardWidth+b},j.prototype.getIJfromIdx=function(a){var b=a%this.boardWidth;return 0>b&&(b+=this.boardWidth),{i:Math.floor(a/this.boardWidth),j:b}},j.prototype.generateBoard=function(){var a,b,c,d;for(var e in this.types)this.types.hasOwnProperty(e)&&(this.gemCnts[this.types[e]]=0);if(64===this.board.length){for(a=0;a<this.board.length;a++)c=this.generateRandomType(),d=this.board[a],d.type=c,d.setBaseSprite(c),d.x=d.j*this.gemWidth+this.gemWidth/2,d.y=d.i*this.gemHeight+this.offsetY+this.gemHeight/2,d.scaleX=1,d.scaleY=1,d.status="ready",d.special=void 0,d.gatherTo=void 0;this.judge.enable()}else for(a=0;a<this.boardHeight;a++)for(b=0;b<this.boardWidth;b++)i?(c=this.types[h[this.getGemIdx(a,b)]],this.gemCnts[c]++):c=this.generateRandomType(),this.board.push(this.game.entityPool.allocate({name:"gem",x:b*this.gemWidth+this.gemWidth/2,y:a*this.gemHeight+this.offsetY+this.gemHeight/2,width:this.gemWidth,height:this.gemHeight,i:a,j:b,anchorX:this.gemWidth/2,anchorY:this.gemHeight/2,type:c,status:"ready",special:void 0,gatherTo:void 0,effect:void 0}).addTo(this.engineBoard.name).setBaseSprite(c));for(;this.hasEmpty()||0!==this.findAllMatches().length;)this.cascade()},j.prototype.generateRandomType=function(){var a;do a=this.types[Math.floor(7*Math.random())];while(this.gemCnts[a]>=13);return++this.gemCnts[a],a},j.prototype.destroyBoard=function(){function a(){0===--b&&this.generateBoard()}this.judge.disable();var b=this.board.length;this.board.forEach(function(b){this.setZoomOutAnimation(b,2*this.animationDuration,"easeInQuad",a.bind(this))},this)},j.prototype.cascade=function(a){if(this.lastpangCalled&&this.isIdle()){var b=this.board.filter(function(a){return a.special});b.length>0?this.doSpecial(b.splice(0,1)[0]):(this.hideHint(),this.judge.disable(),setTimeout(function(){this.lastpangCallback()}.bind(this),1e3))}this.hasEmpty()&&this.fall(a);var d=this.findAllMatches(a);if(d.length>0){{"combo"+Math.min(7,this.comboCnt+1)}a&&this.comboCnt>c.comboCnt?this.explodeNeighbors(d,a):this.explode(d,a)}else this._hintGem=this.findPossibleMatch(),this._hintGem&&a?this.showHint():this.regenerateBoard(a)},j.prototype.regenerateBoard=function(a){this.hideHint(),!this.gameover&&this.board.every(function(a){return a&&"ready"===a.status?!0:void 0})&&(console.log("no possible match found. re-generate board"),a?(this.fire("no possible match",1e3),this.fire("pause",2*this.animationDuration),this.destroyBoard()):this.generateBoard())},j.prototype.explode=function(a,b){var c=this;a=a.filter(function(a){var b=this.board[a];return 0>a||!b||"ready"!==b.status?!1:b.special?(b.type=b.special,!1):!0},this),a.sort(function(a,b){return b-a}),b&&!this.lastpangCalled&&(this.comboCnt++,this.maxCombo=Math.max(this.comboCnt,this.maxCombo)),b&&this.comboCnt>=2&&(this.fire("combo"),clearTimeout(this.hideComboTimer),this.hideComboTimer=setTimeout(function(){this.fire("hide combo")}.bind(this),this.comboTimer)),a.length>0&&this.hideHint(),b&&(this.score+=Math.min(this.comboBonus*(this.comboCnt-1),this.maxComboBonus)),a.forEach(function(a){function d(){for(var d=c.getGemIdx(-1,this.j);c.board[d];)d-=c.boardWidth;c.board[d]=this,c.board[a]=void 0,this.i=Math.floor(d/8),c.gemCnts[this.type]--,b&&this.effect&&(this.effect.enabled=!1,this.effect.destroy(),this.effect=void 0),this.status="ready",this.x=this.j*c.gemWidth+c.gemWidth/2,this.y=this.i*c.gemHeight+c.offsetY+c.gemHeight/2,this.z=0,this.scaleX=1,this.scaleY=1,this.type=c.generateRandomType(),this.setBaseSprite(this.type),this.gatherTo=void 0,this.special=void 0}var e,f=this.board[a];f.status="exploding",b?(this.score+=this.eachPoint,this._applyPangAnimation(f),f.gatherTo&&(e=this.getGemAt(f.gatherTo.i,f.gatherTo.j))&&e.special?this.setLinearAnimation(f,f.gatherTo.i,f.gatherTo.j,this.animationDuration,"easeInQuad",d):this.setZoomOutAnimation(f,this.animationDuration,"easeInQuad",d)):d.call(f)},this)},j.prototype._fallColumn=function(a,b){if(!this.board.some(function(b,c){return b&&c%this.boardWidth===a&&"ready"!==b.status},this)){for(var c,d=[],e=56+a;e>=0;e-=8)if(!this.board[e]){c=e;break}for(e=c;e>=-64;)this.board[e]&&d.push(e),e-=this.boardWidth;var f=this.getIJfromIdx(c);d.forEach(function(a,c){this._fall(a,f.i,c,b)},this)}},j.prototype._applyPangAnimation=function(a){a.effect&&(a.effect.enabled=!1,a.effect.destroy()),a.effect=this.game.entityPool.allocate({name:"effect",width:this.pangAnimWidth,height:this.pangAnimHeight,x:a.x,y:a.y,z:5,anchorX:this.pangAnimWidth/2,anchorY:this.pangAnimHeight/2}).addTo(this.engineBoard.name).setBaseSprite("pang")},j.prototype.doSpecial=function(a){var b=(new Date).getTime();switch(b-this.timeLastMatch<=this.comboTimer?this.comboTimer=Math.max(this.comboTimer-this.comboTimerDesc,this.minComboTimer):(this.comboCnt=0,this.comboTimer=this.initialComboTimer),a.type){case this.specialTypes[3]:this.bomb(a);break;case this.specialTypes[4]:this.cross(a)}this.timeLastMatch=b},j.prototype.bomb=function(a){var b,c,d,e,f,g=[];for(b=-2;2>=b;b++)if(d=Math.abs(b),!(a.i+b<0||a.i+b>=this.boardHeight))for(c=Math.max(0,a.j-(2-d));c<=Math.min(a.j+(2-d),this.boardWidth-1);c++)if((e=this.getGemIdx(a.i+b,c))>=0){if(!(f=this.board[e])||"ready"!==f.status)return;g.push(e)}this.score+=this.bombBonus,this.lastpangCallback||this.fire("pause"),a.special=void 0,this.explode(g,!0)},j.prototype.cross=function(a){var b,c,d,e=[];for(c=0;c<this.boardWidth;c++)!(d=this.getGemAt(a.i,c))||"ready"!==d.status,e.push(this.getGemIdx(a.i,c));for(b=0;b<this.boardHeight;b++)if(a.i!==b){if(!(d=this.getGemAt(b,a.j))||"ready"!==d.status)return;e.push(this.getGemIdx(b,a.j))}this.score+=this.crossBonus,this.lastpangCallback||this.fire("pause"),a.special=void 0,this.explode(e,!0)},j.prototype.explodeNeighbors=function(a,b){var c,d,e,f=[],g=a.length,h=function(a){0>a||a>=this.board.length||f.indexOf(a)<0&&f.push(a)}.bind(this);for(c=0;g>c;c++)e=a[c],d=this.getIJfromIdx(e),h(e),h(e+this.boardWidth),h(e-this.boardWidth),h(this.getGemIdx(d.i,Math.min(d.j+1,this.boardHeight-1))),h(this.getGemIdx(d.i,Math.max(0,d.j-1)));this.explode(f,b)},j.prototype.findMatchAt=function(a,b,c){if(!(0>a||0>b||a>this.boardHeight-1||b>this.boardWidth-1)){var d,e=[],f=[],g=this.getGemAt(a,b);if(c=c||g.type,this.findLinearMatch(e,c,a+1,b,function(a,b){return{i:a+1,j:b}}),this.findLinearMatch(e,c,a-1,b,function(a,b){return{i:a-1,j:b}}),this.findLinearMatch(f,c,a,b+1,function(a,b){return{i:a,j:b+1}}),this.findLinearMatch(f,c,a,b-1,function(a,b){return{i:a,j:b-1}}),e.length<2)e=[];else if(3===e.length||4===e.length)for(d=0;d<e.length;d++)this.board[e[d]].gatherTo={i:a,j:b};if(f.length<2)f=[];else if(3===f.length||4===f.length)for(d=0;d<f.length;d++)this.board[f[d]].gatherTo={i:a,j:b};return{v:e,h:f}}},j.prototype.findLinearMatch=function(a,b,c,d,e){if(this.specialTypes[3]!==b&&this.specialTypes[4]!==b)for(;c>=0&&c<this.boardWidth&&d>=0&&d<this.boardHeight;){var f=this.getGemAt(c,d);if(!f||"ready"!==f.status||f.type!==b)return;a.push(this.getGemIdx(c,d));var g=e(c,d);c=g.i,d=g.j}},j.prototype.findAllMatches=function(a,c,d,e,f){function g(a,b){var c,d,e=a.length;if(this.specialTypes.hasOwnProperty(e)){for(d=0;e>d;d++){if(c=this.board[a[d]],c.gatherTo||c.special||q.special){b=!1;break}c.gatherTo={i:h,j:i}}if(b)return q.special=this.specialTypes[e],q.z=1,q.setBaseSprite(q.special),this.gemCnts[q.type]--,a===k}}var h,i,j=[],k=[],l=[],m=function(a,b){return{i:a+1,j:b}},n=function(a,b){return{i:a,j:b+1}};for(h=c||0;h<=(e||this.boardHeight-1);h++)for(i=d||0;i<=(f||this.boardWidth-1);i++){var o,p,q=this.getGemAt(h,i),r=this.getGemIdx(h,i);q&&(p=q.type,j=[],k=[],this.findLinearMatch(j,p,h+1,i,m),this.findLinearMatch(k,p,h,i+1,n),o=j.length,2>o?j=[]:g.call(this,j,a),o=k.length,2>o?k=[]:g.call(this,k,a),l=b(l,j,k),(k.length>=2||j.length>=2)&&l.indexOf(r)<0&&l.push(r))}return l},j.prototype.findPossibleMatch=function(){var a,b,c,d=[],e=[];for(a=0;a<this.board.length;a++)c=this.getIJfromIdx(a),(b=this.isSwappable(c.i,c.j,c.i+1,c.j))?d.push(b.swappedTo||b.swappedFrom):(b=this.isSwappable(c.i,c.j,c.i,c.j+1))?d.push(b.swappedTo||b.swappedFrom):this.board[a]&&this.board[a].special&&e.push(this.board[a]);return d[Math.floor(Math.random()*d.length)]||e[Math.floor(Math.random()*e.length)]},j.prototype.showHint=function(){this.hintTimer||this.lastpangCalled||(this.hintTimer=setTimeout(function(){this._hintGem&&(this.hint.x>=0&&this.hint.y>=0||(this.hint.x=this._hintGem.x,this.hint.y=this._hintGem.y,this.hint.enable(),this.hintTimer=null))}.bind(this),3e3))},j.prototype.hideHint=function(){this.hintTimer&&(clearTimeout(this.hintTimer),this.hintTimer=null),this.hint.x=-100,this.hint.y=-100,this.hint.disable()},j.prototype.showSelected=function(a){this.selected.animation=null,this.selected.enable(),this.selected.x=a.x,this.selected.y=a.y},j.prototype.hideSelected=function(){this.selected.animation=null,this.selected.x=-100,this.selected.y=-100,this.selected.disable()},j.prototype.isSwappable=function(a,b,c,d){if(!(0>a||0>b||a>this.boardHeight-1||b>this.boardWidth-1||0>c||0>d||c>this.boardHeight-1||d>this.boardWidth-1)){var e,f,g,h,i=this.getGemAt(a,b),j=this.getGemAt(c,d);if(i&&j)return this.isAdjacent(a,b,c,d)&&(h=i.type,i.type=j.type,j.type=h,e=this.findMatchAt(a,b,i.type),f=this.findMatchAt(c,d,j.type),h=i.type,i.type=j.type,j.type=h,(e.v.length>=2||e.h.length>=2)&&(g=g||{},g.swappedTo=j),(f.v.length>=2||f.h.length>=2)&&(g=g||{},g.swappedFrom=i),g&&(g.matchesAtFrom=e,g.matchesAtTo=f)),g}},j.prototype.isAdjacent=function(a,b,c,d){return a===c&&1===Math.abs(b-d)||b===d&&1===Math.abs(a-c)},j.prototype.swap=function(a,b,c,d){function e(){(f=this.isSwappable(a,b,c,d))?(i.status="ready",j.status="ready",j.i=a,j.j=b,this.board[k]=j,i.i=c,i.j=d,this.board[l]=i,g=(new Date).getTime(),g-this.timeLastMatch<=this.comboTimer?this.comboTimer=Math.max(this.comboTimer-this.comboTimerDesc,this.minComboTimer):(this.comboCnt=0,this.comboTimer=this.initialComboTimer),this.timeLastMatch=g,f.swappedFrom&&m.specialTypes.hasOwnProperty(h=Math.max(f.matchesAtTo.v.length,f.matchesAtTo.h.length))&&(i.special=m.specialTypes[h],i.setBaseSprite(i.special),m.gemCnts[i.type]--),f.swappedTo&&m.specialTypes.hasOwnProperty(h=Math.max(f.matchesAtFrom.v.length,f.matchesAtFrom.h.length))&&(j.special=m.specialTypes[h],j.setBaseSprite(j.special),m.gemCnts[j.type]--)):(m.setLinearAnimation(j,c,d,m.animationDuration,"easeInQuad",function(){j.status="ready"}),m.setLinearAnimation(i,a,b,m.animationDuration,"easeInQuad",function(){i.status="ready"}),m.gemOnHand===i&&m.setLinearAnimation(m.selected,a,b,m.animationDuration,"easeInQuad"))}var f,g,h,i=this.getGemAt(a,b),j=this.getGemAt(c,d),k=this.getGemIdx(a,b),l=this.getGemIdx(c,d),m=this;i&&j&&"ready"===i.status&&"ready"===j.status&&(i.status="swapping",j.status="swapping",i.z=1,j.z=0,this.setLinearAnimation(i,c,d,this.animationDuration,"easeInQuad"),this.setLinearAnimation(j,a,b,this.animationDuration,"easeInQuad",e.bind(this)),this.setLinearAnimation(this.selected,c,d,this.animationDuration,"easeInQuad",function(){m.hideSelected()}))},j.prototype.fall=function(a){for(var b=-64;0>b;b++)this.board[b]&&"ready"===this.board[b].status&&this._fallColumn(this.getIJfromIdx(b).j,a)},j.prototype.findEmpty=function(){return this.board.some(function(a){return!a})},j.prototype._fall=function(a,b,c,d){var e=this.board[a];e===this.gemOnHand&&this.hideSelected(),a=+a,b-=c,e.status="falling",d?this.setLinearAnimation(e,b,e.j,this.animationDuration,"easeInQuad",function(){e.i=b,this._fallDone(a,e)}.bind(this)):(e.i=b,e.y=b*this.gemHeight+this.offsetY+this.gemWidth/2,this._fallDone(a,e))},j.prototype._fallDone=function(a,b){b.status="ready";var c=this.getGemIdx(b.i,b.j);this.board[a]===b&&(this.board[a]=void 0),this.board[c]!==b&&(this.board[c]=b)},j.prototype.setLinearAnimation=function(a,b,c,d,e,f){a.animate({duration:d,type:a.gatherTo?"zoomout":void 0,from:{x:a.x,y:a.y},to:{x:c*this.gemWidth+this.gemWidth/2,y:b*this.gemHeight+this.offsetY+this.gemHeight/2},easing:{x:e,y:e},callback:f||function(){}})},j.prototype.setZoomOutAnimation=function(a,b,c,d){a.animate({type:"zoomout",duration:b,from:{scaleX:1,scaleY:1},to:{scaleX:0,scaleY:0},easing:{scaleX:c,scaleY:c},callback:d||function(){}})},j.prototype.getScore=function(){return this.score},j.prototype.getCombo=function(){return this.comboCnt},j.prototype.getMaxCombo=function(){return this.maxCombo},j.prototype.isSelectable=function(a){if("ready"!==a.status)return!1;var b=this.getGemIdx(a.i,a.j)+this.boardWidth;return explodingUnder=this.board.some(function(c,d){return c&&d>b&&d%this.boardWidth===a.j&&"exploding"===c.status},this),!explodingUnder},j.prototype.isIdle=function(){var a=this.board.every(function(a){return a&&"ready"===a.status});return a&&0===this.findAllMatches().length},j.prototype.hasEmpty=function(){return this.board.some(function(a){return!a})},j.prototype.hasError=function(){return this.board.some(function(a){return!a})},j.prototype.hasSpecial=function(){return this.board.some(function(a){return a&&a.special})},j.prototype.onTouchstart=function(a){if(this.touchable){var b,c=a.designX,d=a.designY,e=Math.floor(c/this.gemWidth),g=Math.floor((d-this.offsetY)/this.gemHeight);if(a.preventDefault(),!(0>g||g>=this.boardHeight||0>e||e>=this.boardWidth)&&(b=this.getGemAt(g,e),b&&(b.x===this.hint.x&&b.y===this.hint.y&&this.hideHint(),this.isSelectable(b)))){if(this.gemOnHand=b,this.gemOnHand.special)return void this.doSpecial(this.gemOnHand);this.showSelected(this.gemOnHand),this.game.input.on(f,this.moveHandler)}}},j.prototype.onTouchMove=function(a){var b=a.designX,c=a.designY,d=Math.floor(b/this.gemWidth),e=Math.floor((c-this.offsetY)/this.gemHeight);a.preventDefault(),0>e||e>=this.boardHeight||0>d||d>=this.boardWidth||e===this.gemOnHand.i&&d===this.gemOnHand.j||e!==this.gemOnHand.i&&d!==this.gemOnHand.j||(this.isAdjacent(this.gemOnHand.i,this.gemOnHand.j,e,d)&&this.swap(this.gemOnHand.i,this.gemOnHand.j,e,d),this.game.input.off(f,this.moveHandler))},j.prototype.onTouchEnd=function(){this.game.input.off(f,this.moveHandler)},j.prototype.on=function(a,b){var c=this.registry;c[a]||(c[a]=[]),c[a].push(b)},j.prototype.fire=function(a,b){var c,d=this.registry[a],e=d&&d.length||0;for(c=0;e>c;c++)d[c].call(null,b)},j.prototype.scanBoard=function(a,b){for(var c,d,e=this.board,f=0,g=e.length;g>f;f++)d=e[f],d[a]===b&&(c||(c=[])).push({i:d.i,j:d.j});return c},j.prototype.printBoard=function(){for(var a=[],b=0;b<this.board.length;b++)a.push(this.types.indexOf(this.board[b].type));return a},j.prototype.debug=function(){var a,b=[],c=[],d=0;for(d=-64;64>d;d++)d%8===0&&(a=[],b.push(a)),a.push(this.board[d]?this.board[d].status:null);for(d=-64;64>d;d++)d%8===0&&(a=[],c.push(a)),a.push(this.board[d]?"["+d+"] "+this.board[d].i+", "+this.board[d].j:null);console.table(b),console.table(c)},j});