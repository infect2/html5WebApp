<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Alien Invasion</title>
    <meta name="viewport" content="width=device-width, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        html {
            -webkit-touch-callout:none;
            -webkit-user-select:none;
            -webkit-tap-highlight-color:rgba(0, 0, 0, 0);
            overflow:hidden;
        }
        body {
            padding:0;margin:0;overflow:hidden;
        }
        canvas {
            padding:0;margin:0;overflow:hidden;
        }
    </style>
</head>
<body>
    <div id="container">
        <canvas id='game'></canvas>
    </div>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src='alienInvasionEngine.js'></script>
    <script src='alienInvasionGame.js'></script>
    <script src='gameRunTimeGuest.js'></script>
    <script>
        var gameInst;
        var gameSetting;
        var viewport ={
            width: 0,
            height: 0
        };

        if( typeof gameRunTimeGuest !== "undefined" ){
            gameRunTimeGuest.setStatusCB({
                startCB: function(){
                    AlienInvasionGame.initialize( document.getElementById("game"),sprites, startGame, "images/alienSprites.png", viewport );
                    AlienInvasionGame.gameEndCB = $.proxy( gameRunTimeGuest.onEnd, gameRunTimeGuest );
                    gameRunTimeGuest.onWaiting();
                    //시작되었음을 host에게 알림
                    gameRunTimeGuest.onStarted();
                },
                endCB: function(){
                    //갑자기 종료함
                    console.log("game is terminated by someone");
                },
                screenShotCB: function(){
                    return AlienInvasionGame.captureScreenShot();
                },
                setGameResolutionCB: function( data ){
                    var margin = 16,
                        JSONdata = JSON.parse(data);
                    viewport.width = JSONdata.width;
                    viewport.height = JSONdata.height;
                    // //set up display area
                    // $('iframe').css( {"width": data.width + data.margin||margin,
                                    // "height": data.height + data.margin||margin} );
                },
                getGameResolutionCB: function(){
                    return JSON.stringify({
                        mid: {width:0, height: 0}
                    });
                },
                scaleCanvasCB: function(xScale, yScale){
                    //CSS scaling
                    $('canvas').css({
                        width: $('canvas').width()*xScale,
                        height: $('canvas').height()*yScale
                    });
                    //scaling filter
                    $('canvas').css("image-rendering", "-webkit-optimize-contrast");
                    //event translation
                    AlienInvasionGame.setSizeScale( xScale, yScale );
                },
                gameCustomDataCB: function( data ){
                    var obj = JSON.parse(data);
                    gameSetting = obj;
                }
            });
        }
        gameRunTimeGuest.onReady();
    </script>
</body>
</html>


